# HLS Design Space Optimization with Machine Learning

**–î–∏–ø–ª–æ–º–Ω—ã–π –ø—Ä–æ–µ–∫—Ç:**  
–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –ü–õ–ò–° —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–æ–≤ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∏ –æ–±—É—á–µ–Ω–∏—è —Å –ø–æ–¥–∫—Ä–µ–ø–ª–µ–Ω–∏–µ–º.

---

## üì¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

- **/syn_cases/** ‚Äî –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ —Å–∏–Ω—Ç–µ–∑ —Ç–µ—Å—Ç–æ–≤—ã—Ö –∫–µ–π—Å–æ–≤ (HLS, Vitis)
- **/all_cases/** ‚Äî –ø—Ä–∏–º–µ—Ä—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–µ–π—Å–æ–≤ 
- **/optimizer/** ‚Äî RL-–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è (–ø–æ–∏—Å–∫ –ª—É—á—à–∏—Ö —Ä–µ—à–µ–Ω–∏–π)
- **/GNN/** ‚Äî –≥—Ä–∞—Ñ–æ–≤—ã–µ –Ω–µ–π—Ä–æ–Ω–Ω—ã–µ —Å–µ—Ç–∏ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –º–µ—Ç—Ä–∏–∫ (LUT, DSP, CP)
- **data_preprocess.py, generate_graph_datasets.py, data_info.py** ‚Äî —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—É—á–∞—é—â–µ–≥–æ –Ω–∞–±–æ—Ä–∞, –∞–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö
- **actor_critic.py, rl_env.py, train_rl.py** ‚Äî RL-–∞–≥–µ–Ω—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã—Ö —Ä–µ—à–µ–Ω–∏–π

---

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

1. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–µ–π—Å–æ–≤**
    ```bash
    python syn_cases/Gen_one_case.py
    # –∏–ª–∏
    python syn_cases/Gen_all_cases.py
    ```

2. **–°–∏–Ω—Ç–µ–∑ –∏ —Å–±–æ—Ä –º–µ—Ç—Ä–∏–∫**
    ```bash
    python syn_cases/Run_all_cases.py
    ```

3. **–§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—É—á–∞—é—â–µ–≥–æ –Ω–∞–±–æ—Ä–∞**
    ```bash
    python data_preprocess.py
    python generate_graph_datasets.py
    ```

4. **–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π**
    ```bash
    python GNN/graph_model_lut.py
    python GNN/graph_model_dsp.py
    python GNN/graph_cp_implementation.py
    ```

5. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è RL**
    ```bash
    python train_rl.py
    ```

---

## üõ†Ô∏è –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- Python 3.8+
- torch, torch-geometric, pandas, numpy, scikit-learn, matplotlib, seaborn
- –î–ª—è —Å–∏–Ω—Ç–µ–∑–∞: —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–π Xilinx Vitis HLS (—É–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö!)

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:**
> requirements.txt —Å–æ–¥–µ—Ä–∂–∏—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ, –Ω–æ –Ω–µ –∏—Å–∫–ª—é—á–µ–Ω–æ, —á—Ç–æ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–∞–∫–µ—Ç—ã –≤—Ä—É—á–Ω—É—é. –ï—Å–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø–æ—è–≤–∏—Ç—Å—è –æ—à–∏–±–∫–∞ –∏–º–ø–æ—Ä—Ç–∞ (ImportError), –ø—Ä–æ—Å—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –Ω–µ–¥–æ—Å—Ç–∞—é—â—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É —á–µ—Ä–µ–∑ pip.

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

- –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å–∫—Ä–∏–ø—Ç–∞—Ö –ø—É—Ç—å –∫ Vitis HLS (`D:\Xilinx\Vitis_HLS\2024.2`) –ø—Ä–æ–ø–∏—Å–∞–Ω —è–≤–Ω–æ.  
  **–ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Å–≤–æ–π –ø—É—Ç—å –∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–º—É Vitis HLS** –∏–ª–∏ —É–∫–∞–∂–∏—Ç–µ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è.
- –ü–∞–ø–∫–∞ `/all_cases/` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä—ã, –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ.
- –ü–∞–ø–∫–∞ `/outputs/` –Ω–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ ‚Äî —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã, –≥—Ä–∞—Ñ–∏–∫–∏, –º–æ–¥–µ–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è —Ç—É–¥–∞.

---

## üìä –ü—Ä–∏–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞

_–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π –ø–æ –º–µ—Ç—Ä–∏–∫–∞–º LUT –∏ CP:_

![–°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π](docs/is_best_plot.png)

---
